<!DOCTYPE html>
<html lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">

	<link href="{{url_for('static', filename='css/bootstrap.min.css')}}" rel="stylesheet">
	<link href="{{url_for('static', filename='css/index.css')}}" rel="stylesheet">

	<body>
		<div class="navbar navbar-inverse navbar-purple navbar-fixed-top" role="navigation">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
						<span class="sr-only">Toggle navigation</span>
					</button>
					<a href="index" style="color:#ffffff;" class="navbar-brand">Course Connect</a>
				</div>
				<div class="collapse navbar-collapse">
					<ul class="nav navbar-nav">
					</ul>
				</div>
			</div>
		</div>
	</div>
	<div class="container main">
		<!-- <div class="panel panel-default col-xs-6 panel-margin-top">
			<h3>Search:</h3>
			<div class="form-group col-xs-12">
				<div class="form-group">
					<input autocomplete="off" type="text" class="form-control" id="classes" placeholder="Search classes!">
				</div>
				<div>
					<h5>Term:</h5>
					<select id="terms" class="form-control browse-dropdown">
					</select>
				</div>
				<p></p>
				<div>
					<h5>Department:</h5>
					<select id="departments" class="form-control browse-dropdown">
					</select>
				</div>
				<p></p>
				<ul id="class-list" class="list-group">
					<a class="list-group-item active">List of Classes</a>
				</ul>
			</div>
		</div> -->
		<div class="panel panel-default panel-opacity col-xs-offset-0 col-xs-12 col-sm-offset-3 col-sm-6">
			<div>
				<h3>Rate classes based on the following:</h3>
			</div>
			<h5>Select a class:</h5>
			<div class="form-group col-xs-12">
				<div class="form-group">
					<input autocomplete="off" type="text" class="form-control" id="classes" placeholder="Search classes!">
				</div>
				<ul id="class-list" class="list-group">
					<a class="list-group-item">No class selected...</a>
				</ul>
			</div>
			<div>
				<h5>How fulfilling was the class?</h5>
				<form class="form-horizontal">
					<div class="col-xs-12">
						<div class="col-xs-1">
							<input type="radio" name="1" value="1"> 1</input>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="1" value="2"> 2</input>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="1" value="3"> 3</input>
						</div>
					</div>
				</form>
			</div>
			<div>
				<h5>How light was the workload?</h5>
				<form class="form-horizontal">
					<div class="col-xs-12">
						<div class="col-xs-1">
							<input type="radio" name="2" value="1"> 1<br>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="2" value="2"> 2<br>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="2" value="3"> 3<br>
						</div>
					</div>
				</form>
			</div>
			<div>
				<h5>How clear were the instructions?</h5>
				<form class="form-horizontal">
					<div class="col-xs-12">
						<div class="col-xs-1">
							<input type="radio" name="3" value="1"> 1<br>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="3" value="2"> 2<br>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="3" value="3"> 3<br>
						</div>
					</div>
				</form>
			</div>
			<div>
				<h5>How happy did this class make you feel?</h5>
				<form class="form-horizontal">
					<div class="col-xs-12">
						<div class="col-xs-1">
							<input type="radio" name="4" value="1"> 1<br>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="4" value="2"> 2<br>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="4" value="3"> 3<br>
						</div>
					</div>
				</form>
			</div>
			<div>
				<h5>How good was the quality of this course overall?</h5>
				<form class="form-horizontal">
					<div class="col-xs-12">
						<div class="col-xs-1">
							<input type="radio" name="5" value="1"> 1<br>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="5" value="2"> 2<br>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="5" value="3"> 3<br>
						</div>
					</div>
				</form>
			</div>
			<div>
				<h5>How intellectual easy was this course?</h5>
				<form class="form-horizontal">
					<div class="col-xs-12">
						<div class="col-xs-1">
							<input type="radio" name="6" value="1"> 1<br>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="6" value="2"> 2<br>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="6" value="3"> 3<br>
						</div>
					</div>
				</form>
			</div>
			<div>
				<h5>How much did you learn from this class?</h5>
				<form class="form-horizontal">
					<div class="col-xs-12">
						<div class="col-xs-1">
							<input type="radio" name="7" value="1"> 1<br>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="7" value="2"> 2<br>
						</div>
						<div class="col-xs-1">
							<input type="radio" name="7" value="3"> 3<br>
						</div>
					</div>
				</form>
			</div>
			<button id="rate" class="btn btn-default" style="margin-left: -1px;">Submit Ratings</button>
			<p></p>

		</div>
	</div>
	<script src="{{url_for('static', filename='js/jquery.min.js')}}" rel="stylesheet"></script>
	<script src="{{url_for('static', filename='js/bootstrap.min.js')}}" rel="stylesheet"></script>
	<script src="{{url_for('static', filename='js/typeahead.js')}}"></script>
	<script src="{{url_for('static', filename='js/index.js')}}" rel="stylesheet"></script>
	<script>
	// $.ajax({
	// 	url: "departments",
	// 	success: function(data) {
	// 		$($.parseJSON(data)).map(function() {
	// 			console.log(this.symbol);
	// 			$('#departments').append($('<option>').val(this.symbol).text(this.name));
	// 		});
	// 	}
	// });

	// $.ajax({
	// 	url: "terms",
	// 	success: function(data) {
	// 		$($.parseJSON(data)).map(function() {
	// 			console.log(data);
	// 			$('#terms').append($('<option>').val(this.term_id).text(this.name));
	// 		});
	// 	}
	// });

	// $(".browse-dropdown").change(function(){
	// 	$.ajax({
	// 		url: "courses",
	// 		data: {
	// 			term: $('#terms').val(),
	// 			subject: $('#departments').val()
	// 		},
	// 		success: function(data) {
	// 			$('#class-list').html('<a class="list-group-item active">List of Classes</a>');
	// 			$($.parseJSON(data)).map(function() {
	// 				$('#class-list').append('<li class="list-group-item">' + this.title + '</li>')
	// 			});
	// 		}
	// 	})
	// });

	//builds course array
	var crs = "{{crs}}";
	crs = crs.split("|");
	var courses = [];
	var courseNames = [];
	var classesTaken = [];
	var student_taken = [];
	for (var i = 0; i < crs.length; i++) {
		var course = crs[i].split("::");
		courses.push(course);
		courseNames.push(course[0] + " " + course[1] + " - " + course[9]);
	}

	//allows autocomplete for classes
	$("#classes").typeahead({
		displayKey: 'value',
		source: courseNames,
		updater: function(course) {
			if(classesTaken.length == 0) {
				addTakenClass(course);
			} else {
				classesTaken = [];
				student_taken = [];
				addTakenClass(course);
			}
		}
	});

	//adds when enter is hit
	// $("#classes").keyup(function(e) {
	// 	if (e.keyCode == 13) {
	// 		var course = $("#classes").val();
	// 		addTakenClass(course);
	// 	}
	// });

	// //on click calls recommend_classes
	// $("#suggest").click(function() {
	// 	a=recommend_classes(courses, [], student_taken, "NULL");
	// });

	//on click submits ratings
	$("#rate").click(function() {
		console.log(student_taken);
		$.ajax({
			url: "submit",
			data: {
				name: student_taken[0][1],
				subject: student_taken[0][0],
				one:$('input[name=1]:checked').val(),
				two:$("input[name=2]:checked").val(),
				three:$("input[name=3]:checked").val(),
				four:$("input[name=4]:checked").val(),
				five:$("input[name=5]:checked").val(),
				six:$("input[name=6]:checked").val(),
				seven:$("input[name=7]:checked").val(),
			},
			success: function(data) {
				// $('#class-list').html('<a class="list-group-item active">List of Classes</a>');
				// $($.parseJSON(data)).map(function() {
				// 	$('#class-list').append('<li class="list-group-item">' + this.title + '</li>')
				// });
		window.location = 'index';
	}
})
		//document.location.href="http://127.0.0.1:5000/";
	});

	
	function addTakenClass(course) {
		if(classesTaken.indexOf(course) < 0) {
			student_taken.push(course.split(' '));  
			classesTaken.push(course)
			$("#class-list").html('');
			for(var i = 0; i < classesTaken.length; i++) {
				$("#class-list").append(
					'<li id="class' + i + '" class="list-group-item">' + classesTaken[i] + '<button href="#class' + i + '" class="pull-right btn btn-default remove"><span class="glyphicon glyphicon-remove"</span></button></li>'
					);
				$("#classes").val('');
			}
		}

		$(".remove").click(function() {
			var index = parseInt($(this).attr("href").replace("#class"), 10);
			classesTaken.splice(index, 1);
			student_taken.splice(index, 1)
			$($(this).attr("href")).remove();
			$("#class-list").html('<a class="list-group-item">No class selected...</a>');
		});
	}
	</script>
</body>
</html>